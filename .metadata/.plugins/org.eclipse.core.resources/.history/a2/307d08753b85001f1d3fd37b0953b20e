<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<head>
    <title>퇴직자 목록</title>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <style>
        /* 팝업 스타일 */
        #addRetireePopup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            border: 1px solid black;
            padding: 20px;
            z-index: 1000;
        }
        #popupOverlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }
    </style>
</head>
<body>
    <h2>퇴직자 목록</h2>

    <!-- 퇴직자 추가 버튼 -->
    <button id="openAddRetireePopup">퇴직자 추가</button>

    <!-- 퇴직자 추가 팝업 -->
    <div id="addRetireePopup">
        <h2>퇴직자 추가</h2>
        <form id="addRetireeForm" action="${pageContext.request.contextPath}/retire/add" method="post">
            <label for="retNo">퇴직자 사번:</label>
            <input type="text" id="retNo" name="retNo" required><br><br>

            <label for="gid">유저 GID:</label>
            <input type="text" id="gid" name="gid" required><br><br>

            <label for="retDate">퇴사일:</label>
            <input type="date" id="retDate" name="retDate" required><br><br>

            <label for="exitReason">비고:</label>
            <input type="text" id="exitReason" name="exitReason"><br><br>

            <label for="retTotalDate">총 근무일:</label>
            <input type="number" id="retTotalDate" name="retTotalDate" required><br><br>

            <label for="userEntryDate">입사일:</label>
            <input type="date" id="userEntryDate" name="userEntryDate" required><br><br>

            <input type="submit" value="추가">
            <button type="button" id="closePopup">닫기</button>
        </form>
    </div>

    <!-- 팝업 오버레이 -->
    <div id="popupOverlay"></div>

    <script>
        $(document).ready(function () {
            // 퇴직자 추가 버튼 클릭 시 팝업 열기
            $('#openAddRetireePopup').on('click', function () {
                $('#addRetireePopup').show();
                $('#popupOverlay').show();
            });

            // 팝업 닫기 버튼 클릭 시 팝업 닫기
            $('#closePopup').on('click', function () {
                $('#addRetireePopup').hide();
                $('#popupOverlay').hide();
            });

            // 팝업 제출 처리
            $('#addRetireeForm').on('submit', function (event) {
                event.preventDefault(); // 기본 제출 이벤트 방지

                // AJAX 요청으로 폼 데이터 전송
                $.post($(this).attr('action'), $(this).serialize(), function (response) {
                    alert(response.message); // 응답 메시지 알림
                    if (response.success) {
                        window.location.reload(); // 페이지 새로고침하여 추가된 퇴직자 목록 갱신
                    }
                }, 'json');
            });
        });
    </script>
</body>
</html>
